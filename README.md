# Архитектура сетей
## Задание выполнялось с использованием VirtualBox 6.1.40, использовался vagrant с box-образом generic/debian10
## Задание:

### Теоретическя часть
- Найти свободные подсети
- Посчитать сколько узлов в каждой подсети, включая свободные
- Указать broadcast адрес для каждой подсети
- Проверить нет ли ошибок при разбиении

### Практическая часть
- Соединить офисы в сеть согласно схеме и настроить роутинг
- Все сервера и роутеры должны ходить в инет черз `inetRouter`
- Все сервера должны видеть друг друга
- у всех новых серверов отключить дефолт на нат (eth0), который вагрант поднимает для связи
- при нехватке сетевых интервейсов добавить по несколько адресов на интерфейс

## Результат:

### Теоретическая часть
#### Дано:
Сеть office1
- 192.168.2.0/26 - dev
- 192.168.2.64/26 - test servers
- 192.168.2.128/26 - managers
- 192.168.2.192/26 - office hardware

Сеть office2
- 192.168.1.0/25 - dev
- 192.168.1.128/26 - test servers
- 192.168.1.192/26 - office hardware

Сеть central
- 192.168.0.0/28 - directors
- 192.168.0.32/28 - office hardware
- 192.168.0.64/26 - wifi

```
Office1 ---\
      -----> Central --IRouter --> internet
Office2----/
```
На основании имеющихся данных строим таблицу с подсетями, количеством возможных/занятых узлов в них, широковещательными адресами.
!["Таблица"](https://github.com/mus-cat/otus-stady-m4l26/blob/main/Networks.png)

Из таблицы следует:
1. Сети не пересекаются, т.е. разбиенеие корректно
2. Адресное пространство сетей 192.168.1.0/24 и 192.168.2.0/24 полностью занято (разбито на используемые подсети)
3. В адресном пространстве сети 192.168.0.0/24 есть следующие неиспользуемые диапазоны - 192.168.0.16/28, 192.168.0.48/28, 192.168.0.128/25 
4. Отсутствует адреса для связи между маршрутизаторами. Предлагается выделать отдельную сеть, которая будет "распиливаться" на подсети для обеспечения связи между маршрутизаторами - 192.168.255.0.

Таблица адресов интерфейсов маршрутизаторов будет следующая
Маршрутизатор   |IP/prefix         |Направление (имя соседа)
---|---|---
`inetRouter`    | 192.168.255.1/30  | `centralRouter`
`centralRouter` | 192.168.255.2/30  | `inetRouter`
`centralRouter` | 192.168.255.5/30  | `office1Router`
`centralRouter` | 192.168.255.9/30  | `office2Router`
`office1Router` | 192.168.255.6/30  | `centralRouter`
`office2Router` | 192.168.255.10/30 | `centralRouter`

### Практическая часть
Подготовлены следующие файлы:
- **Vagrant** - настройка и запуск 7 ВМ;
- **inetRouter.yml**, **centralRouter.yml**, **office1Router.yml**, **office2Router.yml**, **inetRouter.yml** - файлы **ansible** содержаший настройки соответствующих ВМ маршрутизаторов;
- **server.yml** - файлы **ansible** выполняющий настройку ВМ с "серверами";

## Пояснения
1. Ко всем ВМ можно подключиться стандартной командой **vagrant ssh <имя_ВМ>**;
2. На всех "маршрутизаторах" добавлены необходимые статические маршруты (в файл **/etc/network/interfaces**);
3. На всех ВМ, за исключением ВМ `inetRouter` изменен "маршрут по-умолчанию" (в файл **/etc/network/interfaces**);
4. Доступ к сети Интернет осуществляется за счёт стандартного для **VirtualBox** NAT-интерфейса на ВМ `inetRouter` и использования на данной машине правила **iptables** для маскарадинга.

## Замечания
1. Использовался только дистрибутив **Debian**
2. Для упрощения на ВМ `inetRouter` сети 192.168.1.0/24 192.168.2.0/24 включены в сеть 192.168.0.0/22
